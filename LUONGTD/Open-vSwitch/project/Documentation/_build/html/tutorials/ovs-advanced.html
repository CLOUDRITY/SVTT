
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Open vSwitch Advanced Features &#8212; Open vSwitch 2.9.2 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="OVN Sandbox" href="ovn-sandbox.html" />
    <link rel="prev" title="OVS Faucet Tutorial" href="faucet.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="open-vswitch-advanced-features">
<h1>Open vSwitch Advanced Features<a class="headerlink" href="#open-vswitch-advanced-features" title="Permalink to this headline">¶</a></h1>
<p>Many tutorials cover the basics of OpenFlow.  This is not such a tutorial.
Rather, a knowledge of the basics of OpenFlow is a prerequisite.  If you do not
already understand how an OpenFlow flow table works, please go read a basic
tutorial and then continue reading here afterward.</p>
<p>It is also important to understand the basics of Open vSwitch before you begin.
If you have never used ovs-vsctl or ovs-ofctl before, you should learn a little
about them before proceeding.</p>
<p>Most of the features covered in this tutorial are Open vSwitch extensions to
OpenFlow.  Also, most of the features in this tutorial are specific to the
software Open vSwitch implementation.  If you are using an Open vSwitch port to
an ASIC-based hardware switch, this tutorial will not help you.</p>
<p>This tutorial does not cover every aspect of the features that it mentions.
You can find the details elsewhere in the Open vSwitch documentation,
especially <code class="docutils literal notranslate"><span class="pre">ovs-ofctl(8)</span></code> and the comments in the
<code class="docutils literal notranslate"><span class="pre">include/openflow/nicira-ext.h</span></code> and <code class="docutils literal notranslate"><span class="pre">include/openvswitch/meta-flow.h</span></code>
header files.</p>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>This is a hands-on tutorial.  To get the most out of it, you will need Open
vSwitch binaries.  You do not, on the other hand, need any physical networking
hardware or even supervisor privilege on your system.  Instead, we will use a
script called <code class="docutils literal notranslate"><span class="pre">ovs-sandbox</span></code>, which accompanies the tutorial, that constructs
a software simulated network environment based on Open vSwitch.</p>
<p>You can use <code class="docutils literal notranslate"><span class="pre">ovs-sandbox</span></code> three ways:</p>
<ul class="simple">
<li>If you have already installed Open vSwitch on your system, then you should be
able to just run <code class="docutils literal notranslate"><span class="pre">ovs-sandbox</span></code> from this directory without any options.</li>
<li>If you have not installed Open vSwitch (and you do not want to install it),
then you can build Open vSwitch according to the instructions in
<a class="reference internal" href="../intro/install/general.html"><span class="doc">Open vSwitch on Linux, FreeBSD and NetBSD</span></a>, without installing it.  Then run
<code class="docutils literal notranslate"><span class="pre">./ovs-sandbox</span> <span class="pre">-b</span> <span class="pre">DIRECTORY</span></code> from this directory, substituting the Open
vSwitch build directory for <code class="docutils literal notranslate"><span class="pre">DIRECTORY</span></code>.</li>
<li>As a slight variant on the latter, you can run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">sandbox</span></code> from an Open
vSwitch build directory.</li>
</ul>
<p>When you run <code class="docutils literal notranslate"><span class="pre">ovs-sandbox</span></code>, it does the following:</p>
<ol class="arabic simple">
<li><strong>CAUTION:</strong> Deletes any subdirectory of the current directory named
“sandbox” and any files in that directory.</li>
<li>Creates a new directory “sandbox” in the current directory.</li>
<li>Sets up special environment variables that ensure that Open vSwitch programs
will look inside the “sandbox” directory instead of in the Open vSwitch
installation directory.</li>
<li>If you are using a built but not installed Open vSwitch, installs the Open
vSwitch manpages in a subdirectory of “sandbox” and adjusts the <code class="docutils literal notranslate"><span class="pre">MANPATH</span></code>
environment variable to point to this directory.  This means that you can
use, for example, <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">ovs-vsctl</span></code> to see a manpage for the <code class="docutils literal notranslate"><span class="pre">ovs-vsctl</span></code>
program that you built.</li>
<li>Creates an empty Open vSwitch configuration database under “sandbox”.</li>
<li>Starts <code class="docutils literal notranslate"><span class="pre">ovsdb-server</span></code> running under “sandbox”.</li>
<li>Starts <code class="docutils literal notranslate"><span class="pre">ovs-vswitchd</span></code> running under “sandbox”, passing special options
that enable a special “dummy” mode for testing.</li>
<li>Starts a nested interactive shell inside “sandbox”.</li>
</ol>
<p>At this point, you can run all the usual Open vSwitch utilities from the nested
shell environment.  You can, for example, use <code class="docutils literal notranslate"><span class="pre">ovs-vsctl</span></code> to create a bridge:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-vsctl add-br br0
</pre></div>
</div>
<p>From Open vSwitch’s perspective, the bridge that you create this way is as real
as any other.  You can, for example, connect it to an OpenFlow controller or
use <code class="docutils literal notranslate"><span class="pre">ovs-ofctl</span></code> to examine and modify it and its OpenFlow flow table.  On the
other hand, the bridge is not visible to the operating system’s network stack,
so <code class="docutils literal notranslate"><span class="pre">ip</span></code> cannot see it or affect it, which means that utilities like <code class="docutils literal notranslate"><span class="pre">ping</span></code>
and <code class="docutils literal notranslate"><span class="pre">tcpdump</span></code> will not work either.  (That has its good side, too: you can’t
screw up your computer’s network stack by manipulating a sandboxed OVS.)</p>
<p>When you’re done using OVS from the sandbox, exit the nested shell (by entering
the “exit” shell command or pressing Control+D).  This will kill the daemons
that <code class="docutils literal notranslate"><span class="pre">ovs-sandbox</span></code> started, but it leaves the “sandbox” directory and its
contents in place.</p>
<p>The sandbox directory contains log files for the Open vSwitch dameons.  You can
examine them while you’re running in the sandboxed environment or after you
exit.</p>
</div>
<div class="section" id="using-gdb">
<h2>Using GDB<a class="headerlink" href="#using-gdb" title="Permalink to this headline">¶</a></h2>
<p>GDB support is not required to go through the tutorial. It is added in case
user wants to explore the internals of OVS programs.</p>
<p>GDB can already be used to debug any running process, with the usual
<code class="docutils literal notranslate"><span class="pre">gdb</span> <span class="pre">&lt;program&gt;</span> <span class="pre">&lt;process-id&gt;</span></code> command.</p>
<p><code class="docutils literal notranslate"><span class="pre">ovs-sandbox</span></code> also has a <code class="docutils literal notranslate"><span class="pre">-g</span></code> option for launching ovs-vswitchd under GDB.
This option can be handy for setting break points before ovs-vswitchd runs, or
for catching early segfaults. Similarly, a <code class="docutils literal notranslate"><span class="pre">-d</span></code> option can be used to run
ovsdb-server under GDB. Both options can be specified at the same time.</p>
<p>In addition, a <code class="docutils literal notranslate"><span class="pre">-e</span></code> option also launches ovs-vswitchd under GDB. However,
instead of displaying a <code class="docutils literal notranslate"><span class="pre">gdb&gt;</span></code> prompt and waiting for user input,
ovs-vswitchd will start to execute immediately. <code class="docutils literal notranslate"><span class="pre">-r</span></code> option is the
corresponding option for running ovsdb-server under gdb with immediate
execution.</p>
<p>To avoid GDB mangling with the sandbox sub shell terminal, <code class="docutils literal notranslate"><span class="pre">ovs-sandbox</span></code>
starts a new xterm to run each GDB session.  For systems that do not support X
windows, GDB support is effectively disabled.</p>
<p>When launching sandbox through the build tree’s make file, the <code class="docutils literal notranslate"><span class="pre">-g</span></code> option
can be passed via the <code class="docutils literal notranslate"><span class="pre">SANDBOXFLAGS</span></code> environment variable.  <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">sandbox</span>
<span class="pre">SANDBOXFLAGS=-g</span></code> will start the sandbox with ovs-vswitchd running under GDB in
its own xterm if X is available.</p>
</div>
<div class="section" id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<p>The goal of this tutorial is to demonstrate the power of Open vSwitch flow
tables.  The tutorial works through the implementation of a MAC-learning switch
with VLAN trunk and access ports.  Outside of the Open vSwitch features that we
will discuss, OpenFlow provides at least two ways to implement such a switch:</p>
<ol class="arabic simple">
<li>An OpenFlow controller to implement MAC learning in a “reactive” fashion.
Whenever a new MAC appears on the switch, or a MAC moves from one switch
port to another, the controller adjusts the OpenFlow flow table to match.</li>
<li>The “normal” action.  OpenFlow defines this action to submit a packet to
“the traditional non-OpenFlow pipeline of the switch”.  That is, if a flow
uses this action, then the packets in the flow go through the switch in the
same way that they would if OpenFlow was not configured on the switch.</li>
</ol>
<p>Each of these approaches has unfortunate pitfalls.  In the first approach,
using an OpenFlow controller to implement MAC learning, has a significant cost
in terms of network bandwidth and latency.  It also makes the controller more
difficult to scale to large numbers of switches, which is especially important
in environments with thousands of hypervisors (each of which contains a virtual
OpenFlow switch).  MAC learning at an OpenFlow controller also behaves poorly
if the OpenFlow controller fails, slows down, or becomes unavailable due to
network problems.</p>
<p>The second approach, using the “normal” action, has different problems.  First,
little about the “normal” action is standardized, so it behaves differently on
switches from different vendors, and the available features and how those
features are configured (usually not through OpenFlow) varies widely.  Second,
“normal” does not work well with other OpenFlow actions.  It is
“all-or-nothing”, with little potential to adjust its behavior slightly or to
compose it with other features.</p>
</div>
<div class="section" id="scenario">
<h2>Scenario<a class="headerlink" href="#scenario" title="Permalink to this headline">¶</a></h2>
<p>We will construct Open vSwitch flow tables for a VLAN-capable,
MAC-learning switch that has four ports:</p>
<dl class="docutils">
<dt>p1</dt>
<dd>a trunk port that carries all VLANs, on OpenFlow port 1.</dd>
<dt>p2</dt>
<dd>an access port for VLAN 20, on OpenFlow port 2.</dd>
<dt>p3, p4</dt>
<dd>both access ports for VLAN 30, on OpenFlow ports 3 and 4, respectively.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The ports’ names are not significant.  You could call them eth1 through eth4,
or any other names you like.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">An OpenFlow switch always has a “local” port as well.  This scenario won’t
use the local port.</p>
</div>
<p>Our switch design will consist of five main flow tables, each of which
implements one stage in the switch pipeline:</p>
<dl class="docutils">
<dt>Table 0</dt>
<dd>Admission control.</dd>
<dt>Table 1</dt>
<dd>VLAN input processing.</dd>
<dt>Table 2</dt>
<dd>Learn source MAC and VLAN for ingress port.</dd>
<dt>Table 3</dt>
<dd>Look up learned port for destination MAC and VLAN.</dd>
<dt>Table 4</dt>
<dd>Output processing.</dd>
</dl>
<p>The section below describes how to set up the scenario, followed by a section
for each OpenFlow table.</p>
<p>You can cut and paste the <code class="docutils literal notranslate"><span class="pre">ovs-vsctl</span></code> and <code class="docutils literal notranslate"><span class="pre">ovs-ofctl</span></code> commands in each of
the sections below into your <code class="docutils literal notranslate"><span class="pre">ovs-sandbox</span></code> shell.  They are also available as
shell scripts in this directory, named <code class="docutils literal notranslate"><span class="pre">t-setup</span></code>, <code class="docutils literal notranslate"><span class="pre">t-stage0</span></code>, <code class="docutils literal notranslate"><span class="pre">t-stage1</span></code>,
…, <code class="docutils literal notranslate"><span class="pre">t-stage4</span></code>.  The <code class="docutils literal notranslate"><span class="pre">ovs-appctl</span></code> test commands are intended for cutting
and pasting and are not supplied separately.</p>
</div>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>To get started, start <code class="docutils literal notranslate"><span class="pre">ovs-sandbox</span></code>.  Inside the interactive shell that it
starts, run this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-vsctl add-br br0 -- set Bridge br0 fail-mode=secure
</pre></div>
</div>
<p>This command creates a new bridge “br0” and puts “br0” into so-called
“fail-secure” mode.  For our purpose, this just means that the OpenFlow flow
table starts out empty.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If we did not do this, then the flow table would start out with a single flow
that executes the “normal” action.  We could use that feature to yield a
switch that behaves the same as the switch we are currently building, but
with the caveats described under “Motivation” above.)</p>
</div>
<p>The new bridge has only one port on it so far, the “local port” br0.  We need
to add <code class="docutils literal notranslate"><span class="pre">p1</span></code>, <code class="docutils literal notranslate"><span class="pre">p2</span></code>, <code class="docutils literal notranslate"><span class="pre">p3</span></code>, and <code class="docutils literal notranslate"><span class="pre">p4</span></code>.  A shell <code class="docutils literal notranslate"><span class="pre">for</span></code> loop is one way to
do it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>for i in 1 2 3 4; do
    ovs-vsctl add-port br0 p$i -- set Interface p$i ofport_request=$i
    ovs-ofctl mod-port br0 p$i up
done
</pre></div>
</div>
<p>In addition to adding a port, the <code class="docutils literal notranslate"><span class="pre">ovs-vsctl</span></code> command above sets its
<code class="docutils literal notranslate"><span class="pre">ofport_request</span></code> column to ensure that port <code class="docutils literal notranslate"><span class="pre">p1</span></code> is assigned OpenFlow port
1, <code class="docutils literal notranslate"><span class="pre">p2</span></code> is assigned OpenFlow port 2, and so on.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We could omit setting the ofport_request and let Open vSwitch choose port
numbers for us, but it’s convenient for the purposes of this tutorial because
we can talk about OpenFlow port 1 and know that it corresponds to <code class="docutils literal notranslate"><span class="pre">p1</span></code>.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ovs-ofctl</span></code> command above brings up the simulated interfaces, which are
down initially, using an OpenFlow request.  The effect is similar to <code class="docutils literal notranslate"><span class="pre">ip</span> <span class="pre">link</span>
<span class="pre">up</span></code>, but the sandbox’s interfaces are not visible to the operating system and
therefore <code class="docutils literal notranslate"><span class="pre">ip</span></code> would not affect them.</p>
<p>We have not configured anything related to VLANs or MAC learning.  That’s
because we’re going to implement those features in the flow table.</p>
<p>To see what we’ve done so far to set up the scenario, you can run a command
like <code class="docutils literal notranslate"><span class="pre">ovs-vsctl</span> <span class="pre">show</span></code> or <code class="docutils literal notranslate"><span class="pre">ovs-ofctl</span> <span class="pre">show</span> <span class="pre">br0</span></code>.</p>
</div>
<div class="section" id="implementing-table-0-admission-control">
<h2>Implementing Table 0: Admission control<a class="headerlink" href="#implementing-table-0-admission-control" title="Permalink to this headline">¶</a></h2>
<p>Table 0 is where packets enter the switch.  We use this stage to discard
packets that for one reason or another are invalid.  For example, packets with
a multicast source address are not valid, so we can add a flow to drop them at
ingress to the switch with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-ofctl add-flow br0 \
    &quot;table=0, dl_src=01:00:00:00:00:00/01:00:00:00:00:00, actions=drop&quot;
</pre></div>
</div>
<p>A switch should also not forward IEEE 802.1D Spanning Tree Protocol (STP)
packets, so we can also add a flow to drop those and other packets with
reserved multicast protocols:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-ofctl add-flow br0 \
    &quot;table=0, dl_dst=01:80:c2:00:00:00/ff:ff:ff:ff:ff:f0, actions=drop&quot;
</pre></div>
</div>
<p>We could add flows to drop other protocols, but these demonstrate the pattern.</p>
<p>We need one more flow, with a priority lower than the default, so that flows
that don’t match either of the “drop” flows we added above go on to pipeline
stage 1 in OpenFlow table 1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-ofctl add-flow br0 &quot;table=0, priority=0, actions=resubmit(,1)&quot;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The “resubmit” action is an Open vSwitch extension to OpenFlow.</p>
</div>
</div>
<div class="section" id="testing-table-0">
<h2>Testing Table 0<a class="headerlink" href="#testing-table-0" title="Permalink to this headline">¶</a></h2>
<p>If we were using Open vSwitch to set up a physical or a virtual switch, then we
would naturally test it by sending packets through it one way or another,
perhaps with common network testing tools like <code class="docutils literal notranslate"><span class="pre">ping</span></code> and <code class="docutils literal notranslate"><span class="pre">tcpdump</span></code> or more
specialized tools like Scapy.  That’s difficult with our simulated switch,
since it’s not visible to the operating system.</p>
<p>But our simulated switch has a few specialized testing tools.  The most
powerful of these tools is <code class="docutils literal notranslate"><span class="pre">ofproto/trace</span></code>.  Given a switch and the
specification of a flow, <code class="docutils literal notranslate"><span class="pre">ofproto/trace</span></code> shows, step-by-step, how such a flow
would be treated as it goes through the switch.</p>
<div class="section" id="example-1">
<h3>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h3>
<p>Try this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 in_port=1,dl_dst=01:80:c2:00:00:05
</pre></div>
</div>
<p>The output should look something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flow</span><span class="p">:</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0000</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">01</span><span class="p">:</span><span class="mi">80</span><span class="p">:</span><span class="n">c2</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">05</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>

<span class="n">bridge</span><span class="p">(</span><span class="s2">&quot;br0&quot;</span><span class="p">)</span>
<span class="o">-------------</span>
 <span class="mf">0.</span> <span class="n">dl_dst</span><span class="o">=</span><span class="mi">01</span><span class="p">:</span><span class="mi">80</span><span class="p">:</span><span class="n">c2</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">f0</span><span class="p">,</span> <span class="n">priority</span> <span class="mi">32768</span>
    <span class="n">drop</span>

<span class="n">Final</span> <span class="n">flow</span><span class="p">:</span> <span class="n">unchanged</span>
<span class="n">Megaflow</span><span class="p">:</span> <span class="n">recirc_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">01</span><span class="p">:</span><span class="mi">80</span><span class="p">:</span><span class="n">c2</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">f0</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>
<span class="n">Datapath</span> <span class="n">actions</span><span class="p">:</span> <span class="n">drop</span>
</pre></div>
</div>
<p>The first line shows the flow being traced, in slightly greater detail
than specified on the command line.  It is mostly zeros because
unspecified fields default to zeros.</p>
<p>The second group of lines shows the packet’s trip through bridge br0.
We see, in table 0, the OpenFlow flow that the fields matched, along
with its priority, followed by its actions, one per line.  In this
case, we see that this packet that has a reserved multicast
destination address matches the flow that drops those packets.</p>
<p>The final block of lines summarizes the results, which are not very
interesting here.</p>
</div>
<div class="section" id="example-2">
<h3>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h3>
<p>Try another command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 in_port=1,dl_dst=01:80:c2:00:00:10
</pre></div>
</div>
<p>The output should be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flow</span><span class="p">:</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0000</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">01</span><span class="p">:</span><span class="mi">80</span><span class="p">:</span><span class="n">c2</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>

<span class="n">bridge</span><span class="p">(</span><span class="s2">&quot;br0&quot;</span><span class="p">)</span>
<span class="o">-------------</span>
 <span class="mf">0.</span> <span class="n">priority</span> <span class="mi">0</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">1</span><span class="p">)</span>
 <span class="mf">1.</span> <span class="n">No</span> <span class="n">match</span><span class="o">.</span>
    <span class="n">drop</span>

<span class="n">Final</span> <span class="n">flow</span><span class="p">:</span> <span class="n">unchanged</span>
<span class="n">Megaflow</span><span class="p">:</span> <span class="n">recirc_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">01</span><span class="p">:</span><span class="mi">80</span><span class="p">:</span><span class="n">c2</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">10</span><span class="o">/</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">f0</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>
<span class="n">Datapath</span> <span class="n">actions</span><span class="p">:</span> <span class="n">drop</span>
</pre></div>
</div>
<p>This time the flow we handed to <code class="docutils literal notranslate"><span class="pre">ofproto/trace</span></code> doesn’t match any of
our “drop” flows in table 0, so it falls through to the low-priority
“resubmit” flow.  The “resubmit” causes a second lookup in OpenFlow
table 1, described by the block of text that starts with “1.”  We
haven’t yet added any flows to OpenFlow table 1, so no flow actually
matches in the second lookup.  Therefore, the packet is still actually
dropped, which means that the externally observable results would be
identical to our first example.</p>
</div>
</div>
<div class="section" id="implementing-table-1-vlan-input-processing">
<h2>Implementing Table 1: VLAN Input Processing<a class="headerlink" href="#implementing-table-1-vlan-input-processing" title="Permalink to this headline">¶</a></h2>
<p>A packet that enters table 1 has already passed basic validation in table 0.
The purpose of table 1 is validate the packet’s VLAN, based on the VLAN
configuration of the switch port through which the packet entered the switch.
We will also use it to attach a VLAN header to packets that arrive on an access
port, which allows later processing stages to rely on the packet’s VLAN always
being part of the VLAN header, reducing special cases.</p>
<p>Let’s start by adding a low-priority flow that drops all packets, before we add
flows that pass through acceptable packets.  You can think of this as a
“default drop” flow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-ofctl add-flow br0 &quot;table=1, priority=0, actions=drop&quot;
</pre></div>
</div>
<p>Our trunk port <code class="docutils literal notranslate"><span class="pre">p1</span></code>, on OpenFlow port 1, is an easy case.  <code class="docutils literal notranslate"><span class="pre">p1</span></code> accepts any
packet regardless of whether it has a VLAN header or what the VLAN was, so we
can add a flow that resubmits everything on input port 1 to the next table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-ofctl add-flow br0 \
    &quot;table=1, priority=99, in_port=1, actions=resubmit(,2)&quot;
</pre></div>
</div>
<p>On the access ports, we want to accept any packet that has no VLAN header, tag
it with the access port’s VLAN number, and then pass it along to the next
stage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-ofctl add-flows br0 - &lt;&lt;&#39;EOF&#39;
table=1, priority=99, in_port=2, vlan_tci=0, actions=mod_vlan_vid:20, resubmit(,2)
table=1, priority=99, in_port=3, vlan_tci=0, actions=mod_vlan_vid:30, resubmit(,2)
table=1, priority=99, in_port=4, vlan_tci=0, actions=mod_vlan_vid:30, resubmit(,2)
EOF
</pre></div>
</div>
<p>We don’t write any flows that match packets with 802.1Q that enter this stage
on any of the access ports, so the “default drop” flow we added earlier causes
them to be dropped, which is ordinarily what we want for access ports.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Another variation of access ports allows ingress of packets tagged with VLAN
0 (aka 802.1p priority tagged packets).  To allow such packets, replace
<code class="docutils literal notranslate"><span class="pre">vlan_tci=0</span></code> by <code class="docutils literal notranslate"><span class="pre">vlan_tci=0/0xfff</span></code> above.</p>
</div>
</div>
<div class="section" id="testing-table-1">
<h2>Testing Table 1<a class="headerlink" href="#testing-table-1" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ofproto/trace</span></code> allows us to test the ingress VLAN flows that we added above.</p>
<div class="section" id="example-1-packet-on-trunk-port">
<h3>Example 1: Packet on Trunk Port<a class="headerlink" href="#example-1-packet-on-trunk-port" title="Permalink to this headline">¶</a></h3>
<p>Here’s a test of a packet coming in on the trunk port:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 in_port=1,vlan_tci=5
</pre></div>
</div>
<p>The output shows the lookup in table 0, the resubmit to table 1, and the
resubmit to table 2 (which does nothing because we haven’t put anything there
yet):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flow</span><span class="p">:</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0005</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>

<span class="n">bridge</span><span class="p">(</span><span class="s2">&quot;br0&quot;</span><span class="p">)</span>
<span class="o">-------------</span>
 <span class="mf">0.</span> <span class="n">priority</span> <span class="mi">0</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">1</span><span class="p">)</span>
 <span class="mf">1.</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">priority</span> <span class="mi">99</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">2</span><span class="p">)</span>
 <span class="mf">2.</span> <span class="n">No</span> <span class="n">match</span><span class="o">.</span>
    <span class="n">drop</span>

<span class="n">Final</span> <span class="n">flow</span><span class="p">:</span> <span class="n">unchanged</span>
<span class="n">Megaflow</span><span class="p">:</span> <span class="n">recirc_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">f0</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>
<span class="n">Datapath</span> <span class="n">actions</span><span class="p">:</span> <span class="n">drop</span>
</pre></div>
</div>
</div>
<div class="section" id="example-2-valid-packet-on-access-port">
<h3>Example 2: Valid Packet on Access Port<a class="headerlink" href="#example-2-valid-packet-on-access-port" title="Permalink to this headline">¶</a></h3>
<p>Here’s a test of a valid packet (a packet without an 802.1Q header) coming in
on access port <code class="docutils literal notranslate"><span class="pre">p2</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 in_port=2
</pre></div>
</div>
<p>The output is similar to that for the previous case, except that it
additionally tags the packet with <code class="docutils literal notranslate"><span class="pre">p2</span></code>’s VLAN 20 before it passes it along to
table 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flow</span><span class="p">:</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0000</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>

<span class="n">bridge</span><span class="p">(</span><span class="s2">&quot;br0&quot;</span><span class="p">)</span>
<span class="o">-------------</span>
 <span class="mf">0.</span> <span class="n">priority</span> <span class="mi">0</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">1</span><span class="p">)</span>
 <span class="mf">1.</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0000</span><span class="p">,</span> <span class="n">priority</span> <span class="mi">99</span>
    <span class="n">mod_vlan_vid</span><span class="p">:</span><span class="mi">20</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">2</span><span class="p">)</span>
 <span class="mf">2.</span> <span class="n">No</span> <span class="n">match</span><span class="o">.</span>
    <span class="n">drop</span>

<span class="n">Final</span> <span class="n">flow</span><span class="p">:</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">dl_vlan</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">dl_vlan_pcp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>
<span class="n">Megaflow</span><span class="p">:</span> <span class="n">recirc_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0000</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">f0</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>
<span class="n">Datapath</span> <span class="n">actions</span><span class="p">:</span> <span class="n">drop</span>
</pre></div>
</div>
</div>
<div class="section" id="example-3-invalid-packet-on-access-port">
<h3>Example 3: Invalid Packet on Access Port<a class="headerlink" href="#example-3-invalid-packet-on-access-port" title="Permalink to this headline">¶</a></h3>
<p>This tests an invalid packet (one that includes an 802.1Q header) coming in on
access port <code class="docutils literal notranslate"><span class="pre">p2</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 in_port=2,vlan_tci=5
</pre></div>
</div>
<p>The output shows the packet matching the default drop flow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flow</span><span class="p">:</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0005</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>

<span class="n">bridge</span><span class="p">(</span><span class="s2">&quot;br0&quot;</span><span class="p">)</span>
<span class="o">-------------</span>
 <span class="mf">0.</span> <span class="n">priority</span> <span class="mi">0</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">1</span><span class="p">)</span>
 <span class="mf">1.</span> <span class="n">priority</span> <span class="mi">0</span>
    <span class="n">drop</span>

<span class="n">Final</span> <span class="n">flow</span><span class="p">:</span> <span class="n">unchanged</span>
<span class="n">Megaflow</span><span class="p">:</span> <span class="n">recirc_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0005</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">f0</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>
<span class="n">Datapath</span> <span class="n">actions</span><span class="p">:</span> <span class="n">drop</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="implementing-table-2-mac-vlan-learning-for-ingress-port">
<h2>Implementing Table 2: MAC+VLAN Learning for Ingress Port<a class="headerlink" href="#implementing-table-2-mac-vlan-learning-for-ingress-port" title="Permalink to this headline">¶</a></h2>
<p>This table allows the switch we’re implementing to learn that the packet’s
source MAC is located on the packet’s ingress port in the packet’s VLAN.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This table is a good example why table 1 added a VLAN tag to packets that
entered the switch through an access port.  We want to associate a MAC+VLAN
with a port regardless of whether the VLAN in question was originally part of
the packet or whether it was an assumed VLAN associated with an access port.</p>
</div>
<p>It only takes a single flow to do this.  The following command adds it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-ofctl add-flow br0 \
    &quot;table=2 actions=learn(table=10, NXM_OF_VLAN_TCI[0..11], \
                           NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[], \
                           load:NXM_OF_IN_PORT[]-&gt;NXM_NX_REG0[0..15]), \
                     resubmit(,3)&quot;
</pre></div>
</div>
<p>The “learn” action (an Open vSwitch extension to OpenFlow) modifies a flow
table based on the content of the flow currently being processed.  Here’s how
you can interpret each part of the “learn” action above:</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">table=10</span></code></dt>
<dd>Modify flow table 10.  This will be the MAC learning table.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">NXM_OF_VLAN_TCI[0..11]</span></code></dt>
<dd>Make the flow that we add to flow table 10 match the same VLAN ID that the
packet we’re currently processing contains.  This effectively scopes the
MAC learning entry to a single VLAN, which is the ordinary behavior for a
VLAN-aware switch.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[]</span></code></dt>
<dd>Make the flow that we add to flow table 10 match, as Ethernet destination,
the Ethernet source address of the packet we’re currently processing.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">load:NXM_OF_IN_PORT[]-&gt;NXM_NX_REG0[0..15]</span></code></dt>
<dd>Whereas the preceding parts specify fields for the new flow to match, this
specifies an action for the flow to take when it matches.  The action is
for the flow to load the ingress port number of the current packet into
register 0 (a special field that is an Open vSwitch extension to OpenFlow).</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A real use of “learn” for MAC learning would probably involve two additional
elements.  First, the “learn” action would specify a hard_timeout for the new
flow, to enable a learned MAC to eventually expire if no new packets were
seen from a given source within a reasonable interval.  Second, one would
usually want to limit resource consumption by using the Flow_Table table in
the Open vSwitch configuration database to specify a maximum number of flows
in table 10.</p>
</div>
<p>This definitely calls for examples.</p>
</div>
<div class="section" id="testing-table-2">
<h2>Testing Table 2<a class="headerlink" href="#testing-table-2" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>Example 1<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Try the following test command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 \
    in_port=1,vlan_tci=20,dl_src=50:00:00:00:00:01 -generate
</pre></div>
</div>
<p>The output shows that “learn” was executed in table 2 and the
particular flow that was added:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flow</span><span class="p">:</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0014</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">50</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>

<span class="n">bridge</span><span class="p">(</span><span class="s2">&quot;br0&quot;</span><span class="p">)</span>
<span class="o">-------------</span>
 <span class="mf">0.</span> <span class="n">priority</span> <span class="mi">0</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">1</span><span class="p">)</span>
 <span class="mf">1.</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">priority</span> <span class="mi">99</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">2</span><span class="p">)</span>
 <span class="mf">2.</span> <span class="n">priority</span> <span class="mi">32768</span>
    <span class="n">learn</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">NXM_OF_VLAN_TCI</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">11</span><span class="p">],</span><span class="n">NXM_OF_ETH_DST</span><span class="p">[]</span><span class="o">=</span><span class="n">NXM_OF_ETH_SRC</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="n">NXM_OF_IN_PORT</span><span class="p">[]</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">15</span><span class="p">])</span>
     <span class="o">-&gt;</span> <span class="n">table</span><span class="o">=</span><span class="mi">10</span> <span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0014</span><span class="o">/</span><span class="mh">0x0fff</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">50</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span> <span class="n">priority</span><span class="o">=</span><span class="mi">32768</span> <span class="n">actions</span><span class="o">=</span><span class="n">load</span><span class="p">:</span><span class="mh">0x1</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">15</span><span class="p">]</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">3</span><span class="p">)</span>
 <span class="mf">3.</span> <span class="n">No</span> <span class="n">match</span><span class="o">.</span>
    <span class="n">drop</span>

<span class="n">Final</span> <span class="n">flow</span><span class="p">:</span> <span class="n">unchanged</span>
<span class="n">Megaflow</span><span class="p">:</span> <span class="n">recirc_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0014</span><span class="o">/</span><span class="mh">0x1fff</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">50</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">f0</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>
<span class="n">Datapath</span> <span class="n">actions</span><span class="p">:</span> <span class="n">drop</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">-generate</span></code> keyword is new.  Ordinarily, <code class="docutils literal notranslate"><span class="pre">ofproto/trace</span></code> has no side
effects: “output” actions do not actually output packets, “learn” actions do
not actually modify the flow table, and so on.  With <code class="docutils literal notranslate"><span class="pre">-generate</span></code>, though,
<code class="docutils literal notranslate"><span class="pre">ofproto/trace</span></code> does execute “learn” actions.  That’s important now, because
we want to see the effect of the “learn” action on table 10.  You can see that
by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-ofctl dump-flows br0 table=10
</pre></div>
</div>
<p>which (omitting the <code class="docutils literal notranslate"><span class="pre">duration</span></code> and <code class="docutils literal notranslate"><span class="pre">idle_age</span></code> fields, which will vary based
on how soon you ran this command after the previous one, as well as some other
uninteresting fields) prints something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NXST_FLOW</span> <span class="n">reply</span> <span class="p">(</span><span class="n">xid</span><span class="o">=</span><span class="mh">0x4</span><span class="p">):</span>
 <span class="n">table</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0014</span><span class="o">/</span><span class="mh">0x0fff</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">50</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span> <span class="n">actions</span><span class="o">=</span><span class="n">load</span><span class="p">:</span><span class="mh">0x1</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
<p>You can see that the packet coming in on VLAN <code class="docutils literal notranslate"><span class="pre">20</span></code> with source MAC
<code class="docutils literal notranslate"><span class="pre">50:00:00:00:00:01</span></code> became a flow that matches VLAN <code class="docutils literal notranslate"><span class="pre">20</span></code> (written in
hexadecimal) and destination MAC <code class="docutils literal notranslate"><span class="pre">50:00:00:00:00:01</span></code>.  The flow loads port
number <code class="docutils literal notranslate"><span class="pre">1</span></code>, the input port for the flow we tested, into register 0.</p>
</div>
<div class="section" id="id2">
<h3>Example 2<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Here’s a second test command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 \
    in_port=2,dl_src=50:00:00:00:00:01 -generate
</pre></div>
</div>
<p>The flow that this command tests has the same source MAC and VLAN as example 1,
although the VLAN comes from an access port VLAN rather than an 802.1Q header.
If we again dump the flows for table 10 with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-ofctl dump-flows br0 table=10
</pre></div>
</div>
<p>then we see that the flow we saw previously has changed to indicate that the
learned port is port 2, as we would expect:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NXST_FLOW</span> <span class="n">reply</span> <span class="p">(</span><span class="n">xid</span><span class="o">=</span><span class="mh">0x4</span><span class="p">):</span>
 <span class="n">table</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0014</span><span class="o">/</span><span class="mh">0x0fff</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">50</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span> <span class="n">actions</span><span class="o">=</span><span class="n">load</span><span class="p">:</span><span class="mh">0x2</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="implementing-table-3-look-up-destination-port">
<h2>Implementing Table 3: Look Up Destination Port<a class="headerlink" href="#implementing-table-3-look-up-destination-port" title="Permalink to this headline">¶</a></h2>
<p>This table figures out what port we should send the packet to based on the
destination MAC and VLAN.  That is, if we’ve learned the location of the
destination (from table 2 processing some previous packet with that destination
as its source), then we want to send the packet there.</p>
<p>We need only one flow to do the lookup:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-ofctl add-flow br0 \
    &quot;table=3 priority=50 actions=resubmit(,10), resubmit(,4)&quot;
</pre></div>
</div>
<p>The flow’s first action resubmits to table 10, the table that the “learn”
action modifies.  As you saw previously, the learned flows in this table write
the learned port into register 0.  If the destination for our packet hasn’t
been learned, then there will be no matching flow, and so the “resubmit” turns
into a no-op.  Because registers are initialized to 0, we can use a register 0
value of 0 in our next pipeline stage as a signal to flood the packet.</p>
<p>The second action resubmits to table 4, continuing to the next pipeline stage.</p>
<p>We can add another flow to skip the learning table lookup for multicast and
broadcast packets, since those should always be flooded:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-ofctl add-flow br0 \
    &quot;table=3 priority=99 dl_dst=01:00:00:00:00:00/01:00:00:00:00:00 \
      actions=resubmit(,4)&quot;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We don’t strictly need to add this flow, because multicast addresses will
never show up in our learning table.  (In turn, that’s because we put a flow
into table 0 to drop packets that have a multicast source address.)</p>
</div>
</div>
<div class="section" id="testing-table-3">
<h2>Testing Table 3<a class="headerlink" href="#testing-table-3" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>Here’s a command that should cause OVS to learn that <code class="docutils literal notranslate"><span class="pre">f0:00:00:00:00:01</span></code> is
on <code class="docutils literal notranslate"><span class="pre">p1</span></code> in VLAN <code class="docutils literal notranslate"><span class="pre">20</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 \
    in_port=1,dl_vlan=20,dl_src=f0:00:00:00:00:01,dl_dst=90:00:00:00:00:01 \
    -generate
</pre></div>
</div>
<p>The output shows (from the “no match” looking up the resubmit to
table 10) that the flow’s destination was unknown:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flow</span><span class="p">:</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">dl_vlan</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">dl_vlan_pcp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="n">f0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">90</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>

<span class="n">bridge</span><span class="p">(</span><span class="s2">&quot;br0&quot;</span><span class="p">)</span>
<span class="o">-------------</span>
 <span class="mf">0.</span> <span class="n">priority</span> <span class="mi">0</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">1</span><span class="p">)</span>
 <span class="mf">1.</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">priority</span> <span class="mi">99</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">2</span><span class="p">)</span>
 <span class="mf">2.</span> <span class="n">priority</span> <span class="mi">32768</span>
    <span class="n">learn</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">NXM_OF_VLAN_TCI</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">11</span><span class="p">],</span><span class="n">NXM_OF_ETH_DST</span><span class="p">[]</span><span class="o">=</span><span class="n">NXM_OF_ETH_SRC</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="n">NXM_OF_IN_PORT</span><span class="p">[]</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">15</span><span class="p">])</span>
     <span class="o">-&gt;</span> <span class="n">table</span><span class="o">=</span><span class="mi">10</span> <span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0014</span><span class="o">/</span><span class="mh">0x0fff</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="n">f0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span> <span class="n">priority</span><span class="o">=</span><span class="mi">32768</span> <span class="n">actions</span><span class="o">=</span><span class="n">load</span><span class="p">:</span><span class="mh">0x1</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">15</span><span class="p">]</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">3</span><span class="p">)</span>
 <span class="mf">3.</span> <span class="n">priority</span> <span class="mi">50</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">10</span><span class="p">)</span>
    <span class="mf">10.</span> <span class="n">No</span> <span class="n">match</span><span class="o">.</span>
            <span class="n">drop</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">4</span><span class="p">)</span>
 <span class="mf">4.</span> <span class="n">No</span> <span class="n">match</span><span class="o">.</span>
    <span class="n">drop</span>

<span class="n">Final</span> <span class="n">flow</span><span class="p">:</span> <span class="n">unchanged</span>
<span class="n">Megaflow</span><span class="p">:</span> <span class="n">recirc_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">dl_vlan</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="n">f0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">90</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>
<span class="n">Datapath</span> <span class="n">actions</span><span class="p">:</span> <span class="n">drop</span>
</pre></div>
</div>
<p>There are two ways that you can verify that the packet’s source was
learned.  The most direct way is to dump the learning table with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-ofctl dump-flows br0 table=10
</pre></div>
</div>
<p>which ought to show roughly the following, with extraneous details removed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0014</span><span class="o">/</span><span class="mh">0x0fff</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="n">f0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span> <span class="n">actions</span><span class="o">=</span><span class="n">load</span><span class="p">:</span><span class="mh">0x1</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you tried the examples for the previous step, or if you did some of your
own experiments, then you might see additional flows there.  These
additional flows are harmless.  If they bother you, then you can remove
them with <cite>ovs-ofctl del-flows br0 table=10</cite>.</p>
</div>
<p>The other way is to inject a packet to take advantage of the learning entry.
For example, we can inject a packet on p2 whose destination is the MAC address
that we just learned on p1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 \
    in_port=2,dl_src=90:00:00:00:00:01,dl_dst=f0:00:00:00:00:01 -generate
</pre></div>
</div>
<p>Here is this command’s output.  Take a look at the lines that trace
the <code class="docutils literal notranslate"><span class="pre">resubmit(,10)</span></code>, showing that the packet matched the learned
flow for the first MAC we used, loading the OpenFlow port number for
the learned port <code class="docutils literal notranslate"><span class="pre">p1</span></code> into register <code class="docutils literal notranslate"><span class="pre">0</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flow</span><span class="p">:</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0000</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">90</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="n">f0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>

<span class="n">bridge</span><span class="p">(</span><span class="s2">&quot;br0&quot;</span><span class="p">)</span>
<span class="o">-------------</span>
 <span class="mf">0.</span> <span class="n">priority</span> <span class="mi">0</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">1</span><span class="p">)</span>
 <span class="mf">1.</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0000</span><span class="p">,</span> <span class="n">priority</span> <span class="mi">99</span>
    <span class="n">mod_vlan_vid</span><span class="p">:</span><span class="mi">20</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">2</span><span class="p">)</span>
 <span class="mf">2.</span> <span class="n">priority</span> <span class="mi">32768</span>
    <span class="n">learn</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">NXM_OF_VLAN_TCI</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">11</span><span class="p">],</span><span class="n">NXM_OF_ETH_DST</span><span class="p">[]</span><span class="o">=</span><span class="n">NXM_OF_ETH_SRC</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="n">NXM_OF_IN_PORT</span><span class="p">[]</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">15</span><span class="p">])</span>
     <span class="o">-&gt;</span> <span class="n">table</span><span class="o">=</span><span class="mi">10</span> <span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0014</span><span class="o">/</span><span class="mh">0x0fff</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">90</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span> <span class="n">priority</span><span class="o">=</span><span class="mi">32768</span> <span class="n">actions</span><span class="o">=</span><span class="n">load</span><span class="p">:</span><span class="mh">0x2</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">15</span><span class="p">]</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">3</span><span class="p">)</span>
 <span class="mf">3.</span> <span class="n">priority</span> <span class="mi">50</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">10</span><span class="p">)</span>
    <span class="mf">10.</span> <span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0014</span><span class="o">/</span><span class="mh">0x0fff</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="n">f0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span> <span class="n">priority</span> <span class="mi">32768</span>
            <span class="n">load</span><span class="p">:</span><span class="mh">0x1</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">15</span><span class="p">]</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">4</span><span class="p">)</span>
 <span class="mf">4.</span> <span class="n">No</span> <span class="n">match</span><span class="o">.</span>
    <span class="n">drop</span>

<span class="n">Final</span> <span class="n">flow</span><span class="p">:</span> <span class="n">reg0</span><span class="o">=</span><span class="mh">0x1</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">dl_vlan</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">dl_vlan_pcp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">90</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="n">f0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>
<span class="n">Megaflow</span><span class="p">:</span> <span class="n">recirc_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0000</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="mi">90</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="n">f0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>
<span class="n">Datapath</span> <span class="n">actions</span><span class="p">:</span> <span class="n">drop</span>
</pre></div>
</div>
<p>If you read the commands above carefully, then you might have noticed that they
simply have the Ethernet source and destination addresses exchanged.  That
means that if we now rerun the first <code class="docutils literal notranslate"><span class="pre">ovs-appctl</span></code> command above, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 \
    in_port=1,dl_vlan=20,dl_src=f0:00:00:00:00:01,dl_dst=90:00:00:00:00:01 \
    -generate
</pre></div>
</div>
<p>then we see in the output, looking at the indented “load” action
executed in table 10, that the destination has now been learned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flow</span><span class="p">:</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">dl_vlan</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">dl_vlan_pcp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="n">f0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">90</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0000</span>

<span class="n">bridge</span><span class="p">(</span><span class="s2">&quot;br0&quot;</span><span class="p">)</span>
<span class="o">-------------</span>
 <span class="mf">0.</span> <span class="n">priority</span> <span class="mi">0</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">1</span><span class="p">)</span>
 <span class="mf">1.</span> <span class="n">in_port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">priority</span> <span class="mi">99</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">2</span><span class="p">)</span>
 <span class="mf">2.</span> <span class="n">priority</span> <span class="mi">32768</span>
    <span class="n">learn</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">NXM_OF_VLAN_TCI</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">11</span><span class="p">],</span><span class="n">NXM_OF_ETH_DST</span><span class="p">[]</span><span class="o">=</span><span class="n">NXM_OF_ETH_SRC</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="n">NXM_OF_IN_PORT</span><span class="p">[]</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">15</span><span class="p">])</span>
     <span class="o">-&gt;</span> <span class="n">table</span><span class="o">=</span><span class="mi">10</span> <span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0014</span><span class="o">/</span><span class="mh">0x0fff</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="n">f0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span> <span class="n">priority</span><span class="o">=</span><span class="mi">32768</span> <span class="n">actions</span><span class="o">=</span><span class="n">load</span><span class="p">:</span><span class="mh">0x1</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">15</span><span class="p">]</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">3</span><span class="p">)</span>
 <span class="mf">3.</span> <span class="n">priority</span> <span class="mi">50</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">10</span><span class="p">)</span>
    <span class="mf">10.</span> <span class="n">vlan_tci</span><span class="o">=</span><span class="mh">0x0014</span><span class="o">/</span><span class="mh">0x0fff</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">90</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span> <span class="n">priority</span> <span class="mi">32768</span>
            <span class="n">load</span><span class="p">:</span><span class="mh">0x2</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">15</span><span class="p">]</span>
    <span class="n">resubmit</span><span class="p">(,</span><span class="mi">4</span><span class="p">)</span>
 <span class="mf">4.</span> <span class="n">No</span> <span class="n">match</span><span class="o">.</span>
    <span class="n">drop</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="implementing-table-4-output-processing">
<h2>Implementing Table 4: Output Processing<a class="headerlink" href="#implementing-table-4-output-processing" title="Permalink to this headline">¶</a></h2>
<p>At entry to stage 4, we know that register 0 contains either the desired output
port or is zero if the packet should be flooded.  We also know that the
packet’s VLAN is in its 802.1Q header, even if the VLAN was implicit because
the packet came in on an access port.</p>
<p>The job of the final pipeline stage is to actually output packets.  The job is
trivial for output to our trunk port <code class="docutils literal notranslate"><span class="pre">p1</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-ofctl add-flow br0 &quot;table=4 reg0=1 actions=1&quot;
</pre></div>
</div>
<p>For output to the access ports, we just have to strip the VLAN header before
outputting the packet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-ofctl add-flows br0 - &lt;&lt;&#39;EOF&#39;
table=4 reg0=2 actions=strip_vlan,2
table=4 reg0=3 actions=strip_vlan,3
table=4 reg0=4 actions=strip_vlan,4
EOF
</pre></div>
</div>
<p>The only slightly tricky part is flooding multicast and broadcast packets and
unicast packets with unlearned destinations.  For those, we need to make sure
that we only output the packets to the ports that carry our packet’s VLAN, and
that we include the 802.1Q header in the copy output to the trunk port but not
in copies output to access ports:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-ofctl add-flows br0 - &lt;&lt;&#39;EOF&#39;
table=4 reg0=0 priority=99 dl_vlan=20 actions=1,strip_vlan,2
table=4 reg0=0 priority=99 dl_vlan=30 actions=1,strip_vlan,3,4
table=4 reg0=0 priority=50            actions=1
EOF
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Our flows rely on the standard OpenFlow behavior that an output action will
not forward a packet back out the port it came in on.  That is, if a packet
comes in on p1, and we’ve learned that the packet’s destination MAC is also
on p1, so that we end up with <code class="docutils literal notranslate"><span class="pre">actions=1</span></code> as our actions, the switch will
not forward the packet back out its input port.  The
multicast/broadcast/unknown destination cases above also rely on this
behavior.</p>
</div>
</div>
<div class="section" id="testing-table-4">
<h2>Testing Table 4<a class="headerlink" href="#testing-table-4" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-1-broadcast-multicast-and-unknown-destination">
<h3>Example 1: Broadcast, Multicast, and Unknown Destination<a class="headerlink" href="#example-1-broadcast-multicast-and-unknown-destination" title="Permalink to this headline">¶</a></h3>
<p>Try tracing a broadcast packet arriving on <code class="docutils literal notranslate"><span class="pre">p1</span></code> in VLAN <code class="docutils literal notranslate"><span class="pre">30</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 \
    in_port=1,dl_dst=ff:ff:ff:ff:ff:ff,dl_vlan=30
</pre></div>
</div>
<p>The interesting part of the output is the final line, which shows that the
switch would remove the 802.1Q header and then output the packet to <code class="docutils literal notranslate"><span class="pre">p3</span></code>
and <code class="docutils literal notranslate"><span class="pre">p4</span></code>, which are access ports for VLAN <code class="docutils literal notranslate"><span class="pre">30</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Datapath</span> <span class="n">actions</span><span class="p">:</span> <span class="n">pop_vlan</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span>
</pre></div>
</div>
<p>Similarly, if we trace a broadcast packet arriving on <code class="docutils literal notranslate"><span class="pre">p3</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 in_port=3,dl_dst=ff:ff:ff:ff:ff:ff
</pre></div>
</div>
<p>then we see that it is output to <code class="docutils literal notranslate"><span class="pre">p1</span></code> with an 802.1Q tag and then to <code class="docutils literal notranslate"><span class="pre">p4</span></code>
without one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Datapath</span> <span class="n">actions</span><span class="p">:</span> <span class="n">push_vlan</span><span class="p">(</span><span class="n">vid</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">pcp</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">pop_vlan</span><span class="p">,</span><span class="mi">4</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Open vSwitch could simplify the datapath actions here to just
<code class="docutils literal notranslate"><span class="pre">4,push_vlan(vid=30,pcp=0),1</span></code> but it is not smart enough to do so.</p>
</div>
<p>The following are also broadcasts, but the result is to drop the packets
because the VLAN only belongs to the input port:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 \
    in_port=1,dl_dst=ff:ff:ff:ff:ff:ff
$ ovs-appctl ofproto/trace br0 \
    in_port=1,dl_dst=ff:ff:ff:ff:ff:ff,dl_vlan=55
</pre></div>
</div>
<p>Try some other broadcast cases on your own:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 \
    in_port=1,dl_dst=ff:ff:ff:ff:ff:ff,dl_vlan=20
$ ovs-appctl ofproto/trace br0 \
    in_port=2,dl_dst=ff:ff:ff:ff:ff:ff
$ ovs-appctl ofproto/trace br0 \
    in_port=4,dl_dst=ff:ff:ff:ff:ff:ff
</pre></div>
</div>
<p>You can see the same behavior with multicast packets and with unicast
packets whose destination has not been learned, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 \
    in_port=4,dl_dst=01:00:00:00:00:00
$ ovs-appctl ofproto/trace br0 \
    in_port=1,dl_dst=90:12:34:56:78:90,dl_vlan=20
$ ovs-appctl ofproto/trace br0 \
    in_port=1,dl_dst=90:12:34:56:78:90,dl_vlan=30
</pre></div>
</div>
</div>
<div class="section" id="example-2-mac-learning">
<h3>Example 2: MAC Learning<a class="headerlink" href="#example-2-mac-learning" title="Permalink to this headline">¶</a></h3>
<p>Let’s follow the same pattern as we did for table 3.  First learn a MAC on port
<code class="docutils literal notranslate"><span class="pre">p1</span></code> in VLAN <code class="docutils literal notranslate"><span class="pre">30</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 \
    in_port=1,dl_vlan=30,dl_src=10:00:00:00:00:01,dl_dst=20:00:00:00:00:01 \
    -generate
</pre></div>
</div>
<p>You can see from the last line of output that the packet’s destination is
unknown, so it gets flooded to both <code class="docutils literal notranslate"><span class="pre">p3</span></code> and <code class="docutils literal notranslate"><span class="pre">p4</span></code>, the other ports in VLAN
<code class="docutils literal notranslate"><span class="pre">30</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Datapath</span> <span class="n">actions</span><span class="p">:</span> <span class="n">pop_vlan</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span>
</pre></div>
</div>
<p>Then reverse the MACs and learn the first flow’s destination on port <code class="docutils literal notranslate"><span class="pre">p4</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 \
    in_port=4,dl_src=20:00:00:00:00:01,dl_dst=10:00:00:00:00:01 -generate
</pre></div>
</div>
<p>The last line of output shows that the this packet’s destination is known to be
<code class="docutils literal notranslate"><span class="pre">p1</span></code>, as learned from our previous command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Datapath</span> <span class="n">actions</span><span class="p">:</span> <span class="n">push_vlan</span><span class="p">(</span><span class="n">vid</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">pcp</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span>
</pre></div>
</div>
<p>Now, if we rerun our first command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ovs-appctl ofproto/trace br0 \
    in_port=1,dl_vlan=30,dl_src=10:00:00:00:00:01,dl_dst=20:00:00:00:00:01 \
    -generate
</pre></div>
</div>
<p>…we can see that the result is no longer a flood but to the specified learned
destination port <code class="docutils literal notranslate"><span class="pre">p4</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Datapath</span> <span class="n">actions</span><span class="p">:</span> <span class="n">pop_vlan</span><span class="p">,</span><span class="mi">4</span>
</pre></div>
</div>
<div class="section" id="contact">
<h4>Contact<a class="headerlink" href="#contact" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="mailto:bugs&#37;&#52;&#48;openvswitch&#46;org">bugs<span>&#64;</span>openvswitch<span>&#46;</span>org</a>
<a class="reference external" href="http://openvswitch.org/">http://openvswitch.org/</a></p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../contents.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Open vSwitch Advanced Features</a><ul>
<li><a class="reference internal" href="#getting-started">Getting Started</a></li>
<li><a class="reference internal" href="#using-gdb">Using GDB</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#scenario">Scenario</a></li>
<li><a class="reference internal" href="#setup">Setup</a></li>
<li><a class="reference internal" href="#implementing-table-0-admission-control">Implementing Table 0: Admission control</a></li>
<li><a class="reference internal" href="#testing-table-0">Testing Table 0</a><ul>
<li><a class="reference internal" href="#example-1">Example 1</a></li>
<li><a class="reference internal" href="#example-2">Example 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-table-1-vlan-input-processing">Implementing Table 1: VLAN Input Processing</a></li>
<li><a class="reference internal" href="#testing-table-1">Testing Table 1</a><ul>
<li><a class="reference internal" href="#example-1-packet-on-trunk-port">Example 1: Packet on Trunk Port</a></li>
<li><a class="reference internal" href="#example-2-valid-packet-on-access-port">Example 2: Valid Packet on Access Port</a></li>
<li><a class="reference internal" href="#example-3-invalid-packet-on-access-port">Example 3: Invalid Packet on Access Port</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-table-2-mac-vlan-learning-for-ingress-port">Implementing Table 2: MAC+VLAN Learning for Ingress Port</a></li>
<li><a class="reference internal" href="#testing-table-2">Testing Table 2</a><ul>
<li><a class="reference internal" href="#id1">Example 1</a></li>
<li><a class="reference internal" href="#id2">Example 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-table-3-look-up-destination-port">Implementing Table 3: Look Up Destination Port</a></li>
<li><a class="reference internal" href="#testing-table-3">Testing Table 3</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-table-4-output-processing">Implementing Table 4: Output Processing</a></li>
<li><a class="reference internal" href="#testing-table-4">Testing Table 4</a><ul>
<li><a class="reference internal" href="#example-1-broadcast-multicast-and-unknown-destination">Example 1: Broadcast, Multicast, and Unknown Destination</a></li>
<li><a class="reference internal" href="#example-2-mac-learning">Example 2: MAC Learning</a><ul>
<li><a class="reference internal" href="#contact">Contact</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../contents.html">Documentation overview</a><ul>
  <li><a href="index.html">Tutorials</a><ul>
      <li>Previous: <a href="faucet.html" title="previous chapter">OVS Faucet Tutorial</a></li>
      <li>Next: <a href="ovn-sandbox.html" title="next chapter">OVN Sandbox</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/tutorials/ovs-advanced.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, The Open vSwitch Development Community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/tutorials/ovs-advanced.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>